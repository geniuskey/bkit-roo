# TASKS: bkit-roo 구현 작업 목록

## 범례

- **상태**: `⬜` 미시작 | `🔄` 진행중 | `✅` 완료
- **우선순위**: `P0` 필수(블로커) | `P1` 높음 | `P2` 보통 | `P3` 낮음
- **의존성**: 해당 태스크를 시작하기 전 완료되어야 하는 태스크 ID

---

## Phase 0: 프로젝트 초기화

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-000 | 프로젝트 계획 문서 작성 | P0 | ✅ | - | PRD, TRD, TASKS 문서 작성 |
| T-001 | 모노레포 초기화 | P0 | ⬜ | T-000 | pnpm workspace, turbo.json, tsconfig.base.json 설정 |
| T-002 | CI/CD 파이프라인 구성 | P1 | ⬜ | T-001 | GitHub Actions: lint, test, build 워크플로 |
| T-003 | 린팅/포매팅 설정 | P1 | ⬜ | T-001 | ESLint + Prettier + 공통 규칙 |
| T-004 | 원본 Roo Code 소스 분석 및 참조 준비 | P0 | ⬜ | T-000 | 원본 리포를 서브모듈 또는 참조용으로 준비 |

---

## Phase 1: 기반 패키지 (`@bkit-roo/shared`)

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-010 | shared 패키지 스캐폴딩 | P0 | ⬜ | T-001 | 패키지 구조, package.json, tsconfig.json 생성 |
| T-011 | API 관련 타입 정의 | P0 | ⬜ | T-010 | `ApiConfiguration`, `ModelInfo`, `ApiProvider` 등 |
| T-012 | 메시지 타입 정의 | P0 | ⬜ | T-010 | `Message`, `MessageBlock`, `ContentBlock` 등 Anthropic 호환 |
| T-013 | 도구 관련 타입 정의 | P0 | ⬜ | T-010 | `ToolDefinition`, `ToolGroup`, `ToolParameter` 등 |
| T-014 | 모드 관련 타입 정의 | P0 | ⬜ | T-010 | `ModeConfig`, `ModeSlug`, `ModePermissions` 등 |
| T-015 | MCP 관련 타입 정의 | P1 | ⬜ | T-010 | `McpServerConfig`, `McpToolInfo`, `McpResourceInfo` 등 |
| T-016 | 플랫폼 추상화 인터페이스 | P0 | ⬜ | T-010 | `IFileSystem`, `ITerminalExecutor`, `IApprovalGate`, `IConfigStorage` |
| T-017 | 상수 정의 | P1 | ⬜ | T-010 | 모델 ID, 컨텍스트 윈도우 크기, 도구 그룹 상수 |
| T-018 | shared 패키지 테스트 | P1 | ⬜ | T-011~T-017 | 타입 호환성 검증, 인터페이스 Mock 테스트 |

---

## Phase 2: 독립 유틸리티 패키지

### 2A: `@bkit-roo/cost`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-020 | cost 패키지 스캐폴딩 | P1 | ⬜ | T-010 | 패키지 구조 생성 |
| T-021 | 프로바이더별 토큰 가격 데이터 | P1 | ⬜ | T-020 | 원본 `src/shared/api.ts`에서 가격 정보 이식 |
| T-022 | 비용 계산 함수 구현 | P1 | ⬜ | T-021 | `calculateCost()`, 캐시 읽기/쓰기 비용 포함 |
| T-023 | API 메트릭 집계 함수 | P1 | ⬜ | T-022 | `getApiMetrics()` 구현 |
| T-024 | cost 패키지 테스트 | P1 | ⬜ | T-021~T-023 | 원본 테스트 케이스 이식 |

### 2B: `@bkit-roo/file-rules`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-030 | file-rules 패키지 스캐폴딩 | P1 | ⬜ | T-010 | 패키지 구조 생성 |
| T-031 | .rooignore 파서 구현 | P1 | ⬜ | T-030 | gitignore 호환 규칙 파싱 |
| T-032 | .rooprotected 파서 구현 | P1 | ⬜ | T-030 | 보호 파일 규칙 파싱 |
| T-033 | glob 매칭 엔진 | P1 | ⬜ | T-030 | 경로 패턴 매칭 로직 |
| T-034 | file-rules 패키지 테스트 | P1 | ⬜ | T-031~T-033 | 다양한 패턴 매칭 테스트 |

### 2C: `@bkit-roo/parser`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-040 | parser 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-041 | AssistantMessageParser 이식 | P0 | ⬜ | T-040 | XML 태그 기반 도구 호출 파싱 로직 이식 |
| T-042 | 스트리밍 파서 구현 | P0 | ⬜ | T-041 | 부분 메시지 실시간 파싱 지원 |
| T-043 | 멘션 파서 구현 | P1 | ⬜ | T-040 | `@file`, `@url` 등 멘션 구문 파싱 |
| T-044 | 멘션 리졸버 인터페이스 | P1 | ⬜ | T-043 | `IMentionResolver` 인터페이스 및 기본 구현 |
| T-045 | parser 패키지 테스트 | P0 | ⬜ | T-041~T-044 | 원본 파서 테스트 이식, 엣지 케이스 추가 |

---

## Phase 3: 핵심 기능 패키지

### 3A: `@bkit-roo/api-client`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-050 | api-client 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-051 | 추상 기본 핸들러 구현 | P0 | ⬜ | T-050 | `ApiHandler` 인터페이스, 기본 구현 |
| T-052 | Anthropic 프로바이더 이식 | P0 | ⬜ | T-051 | Claude 모델 지원 (주력 프로바이더) |
| T-053 | OpenAI 프로바이더 이식 | P0 | ⬜ | T-051 | GPT 모델 지원 |
| T-054 | Google 프로바이더 이식 | P1 | ⬜ | T-051 | Gemini 모델 지원 |
| T-055 | OpenRouter 프로바이더 이식 | P1 | ⬜ | T-051 | 멀티 모델 라우팅 |
| T-056 | Ollama 프로바이더 이식 | P1 | ⬜ | T-051 | 로컬 모델 지원 |
| T-057 | Bedrock 프로바이더 이식 | P2 | ⬜ | T-051 | AWS Bedrock 지원 |
| T-058 | Vertex 프로바이더 이식 | P2 | ⬜ | T-051 | GCP Vertex AI 지원 |
| T-059 | 기타 프로바이더 이식 | P3 | ⬜ | T-051 | Mistral, DeepSeek, Groq 등 나머지 |
| T-060 | buildApiHandler 팩토리 구현 | P0 | ⬜ | T-052~T-056 | 프로바이더 선택 팩토리 |
| T-061 | 모델 캐시 및 페처 | P1 | ⬜ | T-060 | 모델 목록 캐싱, 자동 갱신 |
| T-062 | 스트림 변환 유틸리티 | P0 | ⬜ | T-051 | 프로바이더별 스트림 → 통합 ApiStream 변환 |
| T-063 | 메시지 포맷 변환 | P0 | ⬜ | T-051 | Anthropic 포맷 ↔ OpenAI 포맷 변환 |
| T-064 | api-client 테스트 | P0 | ⬜ | T-052~T-063 | 프로바이더별 단위 테스트, 모의 응답 |

### 3B: `@bkit-roo/tools`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-070 | tools 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-071 | 도구 정의 스키마 이식 | P0 | ⬜ | T-070 | 모든 도구의 이름, 파라미터, 설명 이식 |
| T-072 | 도구 그룹 분류 구현 | P0 | ⬜ | T-071 | read, edit, command, mcp 그룹 관리 |
| T-073 | 승인 게이트 구현 | P0 | ⬜ | T-070 | `IApprovalGate` 기반 도구 실행 전 승인 흐름 |
| T-074 | 도구 실행기 추상 클래스 | P1 | ⬜ | T-071 | `ToolExecutor` 베이스 클래스 |
| T-075 | 도구 설명 생성 함수 | P0 | ⬜ | T-071 | 시스템 프롬프트용 도구 XML 설명 생성 |
| T-076 | tools 패키지 테스트 | P0 | ⬜ | T-071~T-075 | 스키마 검증, 그룹 필터링 테스트 |

### 3C: `@bkit-roo/modes`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-080 | modes 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-081 | 빌트인 모드 정의 이식 | P0 | ⬜ | T-080 | Code, Architect, Ask, Debug, Orchestrator |
| T-082 | 모드별 도구 권한 로직 | P0 | ⬜ | T-081, T-072 | 모드 → 허용 도구 그룹 매핑 |
| T-083 | CustomModesManager 이식 | P1 | ⬜ | T-080 | 커스텀 모드 CRUD, IConfigStorage 기반 |
| T-084 | 모드별 스티키 모델 지원 | P2 | ⬜ | T-083 | 모드별 모델 바인딩 관리 |
| T-085 | modes 패키지 테스트 | P1 | ⬜ | T-081~T-084 | 모드 권한, 커스텀 모드 CRUD 테스트 |

### 3D: `@bkit-roo/prompts`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-090 | prompts 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-091 | 역할 정의 섹션 구현 | P0 | ⬜ | T-090 | 모드별 AI 역할 설명 생성 |
| T-092 | 도구 설명 섹션 구현 | P0 | ⬜ | T-090, T-075 | 모드별 허용 도구만 포함한 도구 설명 생성 |
| T-093 | 기능 목록 섹션 구현 | P1 | ⬜ | T-090 | 모드별 활성 기능 나열 |
| T-094 | 규칙 섹션 구현 | P1 | ⬜ | T-090 | 동작 규칙, 제약사항 |
| T-095 | 커스텀 프롬프트 병합 | P1 | ⬜ | T-090 | 사용자 커스텀 인스트럭션 병합 로직 |
| T-096 | MCP 도구 설명 포함 | P1 | ⬜ | T-090 | MCP 서버의 도구/리소스를 프롬프트에 자동 포함 |
| T-097 | generateSystemPrompt() 통합 | P0 | ⬜ | T-091~T-096 | 전체 섹션 조합하여 완성된 시스템 프롬프트 생성 |
| T-098 | prompts 패키지 테스트 | P0 | ⬜ | T-091~T-097 | 생성된 프롬프트 스냅샷 테스트 |

---

## Phase 4: 고급 기능 패키지

### 4A: `@bkit-roo/mcp-client`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-100 | mcp-client 패키지 스캐폴딩 | P1 | ⬜ | T-010 | 패키지 구조 생성 |
| T-101 | stdio 트랜스포트 구현 | P1 | ⬜ | T-100 | 자식 프로세스 기반 MCP 서버 연결 |
| T-102 | SSE 트랜스포트 구현 | P2 | ⬜ | T-100 | Server-Sent Events 기반 연결 |
| T-103 | Streamable HTTP 트랜스포트 | P2 | ⬜ | T-100 | HTTP 스트리밍 기반 연결 |
| T-104 | McpHub 구현 | P1 | ⬜ | T-101~T-103 | 멀티 서버 연결 허브 |
| T-105 | 도구 발견 및 호출 | P1 | ⬜ | T-104 | MCP 서버의 도구 목록 조회 및 실행 |
| T-106 | 리소스 접근 | P2 | ⬜ | T-104 | MCP 서버의 리소스 조회 |
| T-107 | 설정 파일 로더 | P1 | ⬜ | T-100 | mcp_settings.json, .roo/mcp.json 로딩 |
| T-108 | 연결 상태 모니터링 | P2 | ⬜ | T-104 | 서버 연결 상태 추적, 자동 재연결 |
| T-109 | mcp-client 테스트 | P1 | ⬜ | T-101~T-108 | 모의 MCP 서버와 통합 테스트 |

### 4B: `@bkit-roo/context`

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-110 | context 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-111 | 토큰 예산 관리자 구현 | P0 | ⬜ | T-110 | 모델별 컨텍스트 윈도우 기반 토큰 예산 계산 |
| T-112 | 컨텍스트 윈도우 트래커 | P1 | ⬜ | T-111 | 실시간 토큰 사용량 추적 |
| T-113 | 컨텍스트 컨덴서 구현 | P1 | ⬜ | T-110, T-050 | LLM 기반 대화 요약/압축 |
| T-114 | 파일 컨텍스트 트래커 | P2 | ⬜ | T-110 | 대화에서 참조된 파일 추적 |
| T-115 | 메시지 이력 관리 | P1 | ⬜ | T-110 | 직렬화/역직렬화, 저장/로딩 |
| T-116 | context 패키지 테스트 | P1 | ⬜ | T-111~T-115 | 토큰 예산 계산, 압축 로직 테스트 |

---

## Phase 5: 통합 오케스트레이터 (`@bkit-roo/core`)

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-120 | core 패키지 스캐폴딩 | P0 | ⬜ | T-010 | 패키지 구조 생성 |
| T-121 | BkitRooConfig 설계 | P0 | ⬜ | T-016, T-120 | 전체 설정 통합 인터페이스 |
| T-122 | AgentRunner 구현 | P0 | ⬜ | 모든 Phase 3~4 | 에이전트 실행 루프 (메시지 → LLM → 파싱 → 도구 실행 → 반복) |
| T-123 | TaskManager 구현 | P0 | ⬜ | T-122 | 태스크 상태 머신 (생성, 진행, 완료, 에러) |
| T-124 | 스트리밍 이벤트 시스템 | P0 | ⬜ | T-122 | `AgentEvent` 기반 실시간 이벤트 스트리밍 |
| T-125 | 설정 프록시(ConfigProxy) | P1 | ⬜ | T-121 | 3계층 저장소 (글로벌, 프로젝트, 시크릿) |
| T-126 | 안전 장치 구현 | P1 | ⬜ | T-122 | 연속 실패 감지, 루프 방지, 리소스 제한 |
| T-127 | core 패키지 테스트 | P0 | ⬜ | T-122~T-126 | 전체 파이프라인 통합 테스트 |

---

## Phase 6: 예제 및 문서화

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-130 | CLI 에이전트 예제 | P1 | ⬜ | T-122 | Node.js CLI 기반 AI 코딩 에이전트 데모 |
| T-131 | 심플 채팅 예제 | P1 | ⬜ | T-050, T-040 | 최소 코드 LLM 채팅 데모 |
| T-132 | 각 패키지 API 문서(TSDoc) | P1 | ⬜ | Phase 1~5 | 공개 API에 TSDoc 주석 추가 |
| T-133 | 마이그레이션 가이드 작성 | P2 | ⬜ | Phase 1~5 | Roo Code → bkit-roo 전환 가이드 |
| T-134 | 프로젝트 README 작성 | P1 | ⬜ | T-001 | 프로젝트 소개, 빠른 시작, 설치 방법 |

---

## Phase 7: 품질 보증 및 릴리스

| ID | 태스크 | 우선순위 | 상태 | 의존성 | 설명 |
|----|--------|---------|------|--------|------|
| T-140 | 원본 테스트 호환성 검증 | P1 | ⬜ | Phase 1~5 | 원본 Roo Code의 관련 테스트를 bkit-roo에서 실행 |
| T-141 | VS Code 독립성 검증 | P0 | ⬜ | Phase 1~5 | `vscode` import가 없는지 자동 검사 스크립트 |
| T-142 | 번들 크기 분석 | P2 | ⬜ | Phase 1~5 | 각 패키지 번들 크기 측정 및 최적화 |
| T-143 | Changesets 설정 | P2 | ⬜ | T-001 | 버전 관리 및 체인지로그 자동화 |
| T-144 | npm publish 준비 | P2 | ⬜ | T-143 | 패키지 공개 설정, npm provenance |
| T-145 | v0.1.0 릴리스 | P1 | ⬜ | T-140~T-144 | 첫 번째 알파 릴리스 |

---

## 작업 순서 요약 (크리티컬 패스)

```
T-001 (모노레포 초기화)
  └─→ T-010~T-017 (shared 패키지)
        ├─→ T-040~T-045 (parser)
        ├─→ T-070~T-076 (tools)
        ├─→ T-020~T-024 (cost)
        └─→ T-050~T-064 (api-client)
              └─→ T-080~T-085 (modes)
                    └─→ T-090~T-098 (prompts)
                          └─→ T-100~T-109 (mcp-client)
                          └─→ T-110~T-116 (context)
                                └─→ T-120~T-127 (core)
                                      └─→ T-130~T-134 (예제/문서)
                                            └─→ T-140~T-145 (품질/릴리스)
```

**병렬 가능 작업 그룹**:
- `parser`, `tools`, `cost`, `file-rules`는 `shared` 완료 후 병렬 진행 가능
- `api-client`와 `tools`는 병렬 진행 가능
- `modes`와 `prompts`는 `tools` 완료 후 병렬 진행 가능 (단, `prompts`는 `modes` 부분 의존)
- `mcp-client`와 `context`는 병렬 진행 가능

---

## 예상 작업량 (태스크 수 기준)

| Phase | 태스크 수 | 주요 패키지 |
|-------|----------|------------|
| Phase 0: 초기화 | 5 | 프로젝트 설정 |
| Phase 1: 기반 | 9 | @bkit-roo/shared |
| Phase 2: 유틸리티 | 14 | cost, file-rules, parser |
| Phase 3: 핵심 기능 | 37 | api-client, tools, modes, prompts |
| Phase 4: 고급 기능 | 17 | mcp-client, context |
| Phase 5: 통합 | 8 | @bkit-roo/core |
| Phase 6: 문서 | 5 | 예제, 문서화 |
| Phase 7: 릴리스 | 6 | 품질, 배포 |
| **합계** | **101** | |
